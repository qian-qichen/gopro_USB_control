## 文件说明
- cam_ID.yaml:记录相机编号的配置文件，需要根据gopro相机序列号修正
- CLI tool
    - cam_init.py：初始化（usb控制启用与解除）
    - cam_shutter.py: 快门控制
    - handle_file.py: 提供文件功能
    - cam_watch.py: 监控相机状态
- frame extract:
    - markframe.py: 标记需要提取的帧的时间位置
    - extra_frame.py： 光同步并提取帧

### 相机监视脚本
~~~
cam_watch -i 1 # -i 决定数据刷新间隔,默认取1
~~~
&emsp;&emsp;一个命令行工具,在命令行中启动即可,占用当前命令行.主要用于监视是否过热,是否正在在拍摄,及剩余拍摄时间.
### USB控制
~~~
cam_init -f 1 # -f 控制API信号,1表示启动USB控制,0表示退出控制,默认取1
~~~
&emsp;&emsp;在USB控制状态下可以从电脑端控制相机快门.如果成功进入USB状态,相机背面屏幕应从图案显示切换回拍摄内容预览.
### 存储卡容量
&emsp;&emsp;在启动了相机监控脚本的窗口中可以看到剩余的拍摄时间.删除旧媒体内容腾出空间见[*handle_file 脚本*](#handle_file脚本)
### 启动与关闭快门
~~~
cam_shutter -f 1 # -f 控制API信号,1表示开始拍摄,0表示停止拍摄,默认取0
~~~
&emsp;&emsp;视频拍摄时,相机应闪烁红灯.最好在开始拍摄后于运行相机监视脚本的窗口中检查拍摄是否启动.
### 拍摄期间
&emsp;&emsp;可以通过相机监视脚本查看已拍摄时间;观察是否过热.
### 导出数据
使用[*handle_file 脚本*](#handle_file脚本)导出数据.
### handle_file 脚本
~~~
handle_file # 可以通过-h   查看各参数的作用.支持批量下载与删除.
~~~
---
***务必在执行删除操作前刷新本地媒体列表,避免误删除.<br>目前未发现撤回相机端删除操作的方法***
---
---
&emsp;&emsp;用于处理相机文件媒体文件的脚本工具.当通过文件创建顺序指定文件时(删除或下载),脚本会自动处理gopro的视频分段,多个视频片段会被视作同一个视频,在排序时共占一个序号,同时下载或删除.支持按照配置文件批量下载媒体内容。
#### 典型用法
- 刷新本地媒体记录:
~~~
handle_file -s
~~~
- 在所有相机上下载最新创建的媒体文件
~~~
handle_file -s -d 0
~~~
- 在所有相机上下载按创建时间排序(从0开始计数)为2的媒体文件
~~~
handle_file -s -d 2
~~~
- 在所有相机上删除最新创建的媒体文件
~~~
hand_flie -s --delete 0
~~~
#### 主要参数及作用:
- -s:在执行其他操作前刷新本地媒体文件列表
- -dp:指定下载内容的存放位置,默认取"./download",如使用下载计划文件,会忽略该配置
- -ck:流式下载的缓存块大小,影响下载速度.过大可能导致下载失败.默认取8x1024x1024B
- --delete:删除文件,接受参数$delete$:
  - 自然数:在所有相机上删除媒体记录中创建日期从新到旧的第$delete$个媒体文件,**从0开始计数**
- -d:将媒体文件下载到本地,接受参数$d$:
  - 自然数:在所有相机上下载媒体记录中创建日期从新到旧的第$delete$个媒体文件,**从0开始计数**
  - 字符串:参数$d$为有效文件地址,读取对应下载计划文件并执行下载;保存至下载计划文件指定保存位置,忽略 -dp参数.
- 其他参数请参考 -h 输出内容(请忽略拼写错误:-)


## 可能遇到的问题
- 通电后相机背面屏幕未亮起:部分相机需要通电后手动按开机按钮启动
- 相机启动后且USB线连接后背面屏幕未显示'USB已连接'标识:断电重启.

## 下载配置文件
- 媒体文件序号按照创建时间从新到旧排序
- 保存路径是相对执行位置的相对路径
```json
{
  "index": {
    "saving place 1": [media index 1, media index 2, ...],
    "saving place 1": [media index 3, ...]
  }
}
```